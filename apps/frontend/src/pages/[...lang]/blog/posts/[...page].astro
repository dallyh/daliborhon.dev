---
import { locales } from "shared/frontend/i18n";
import { getRoutingLocale } from "@i18n/utils";
import BlogPostsLayout from "@layouts/BlogPostsLayout.astro";
import type { GetStaticPathsOptions } from "astro";
import { siteConfig } from "shared/frontend";
import { getAllBlogArticlesByLocale } from "@services/content/getAllBlogArticlesByLocale";

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
    const paths = await Promise.all(
        locales.map(async (locale) => {
            const posts = (await getAllBlogArticlesByLocale({ locale })) ?? [];

            return paginate(posts, {
                params: { lang: getRoutingLocale(locale) },
                pageSize: siteConfig.blog.pageSize,
            });
        }),
    );

    return paths.flat();
}

const { page } = Astro.props;
---

<BlogPostsLayout page={page} />
