---
import type { CollectionEntry } from "astro:content";
import FormattedDate from "@components/astro/global/FormattedDate.astro";
import { getLocale } from "@i18n/utils";
import { getRelativeLocaleUrl } from "astro:i18n";

interface Props {
    post: CollectionEntry<"posts">;
    url: string;
}

const { post, url } = Astro.props;
const locale = getLocale(Astro.url);
---

<div class="post-preview">
    <img src={post.data.image.url} width="300" alt={post.data.image.alt} />
    <div class="post-description">
        <a href={url} class="post-title">{post.data.title}</a>
        <p>Written by {post.data.author}</p>
        <p>Published on: <FormattedDate date={post.data.pubDate} locale={locale} /></p>
        <ul class="tag-list">
            {
                post.data.tags.map((tag) => (
                    <li>
                        <a href={getRelativeLocaleUrl(locale, `/blog/tags/${tag}/`)}>#{tag}</a>
                    </li>
                ))
            }
        </ul>
    </div>
</div>

<style>
    .post-preview {
        display: flex;
        flex-direction: column;
        background: rgba(var(--secondary), 1);
        border-radius: 6px;
        width: 300px;
        height: max-content;
        padding: 0.5rem;
        box-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.2);
        line-height: 2;
    }

    .tag-list {
        display: flex;
        gap: 0.2rem;
        flex-wrap: wrap;

        a {
            background: var(--bg-color);
            padding: 0.4rem;
            border-radius: 6px;
            font-size: 0.8rem;
        }
    }

    img {
        display: block;
        width: 300px;
        height: 170px;
        object-fit: contain;
    }

    p {
        font-size: 0.825rem;
    }

    a {
        font-size: 1.2rem;
    }
</style>
