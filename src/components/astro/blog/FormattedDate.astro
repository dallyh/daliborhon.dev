---
import * as m from "$messages";

interface Props {
    pubDateTime: string | Date;
    modDatetime: string | Date | null;
    locale: string;
}

const { pubDateTime, modDatetime, locale } = Astro.props;

const wasUpdated = () => {
    if (modDatetime && pubDateTime) {
        return !(new Date(pubDateTime).getTime() === new Date(modDatetime).getTime());
    }
};

const formattedDatetime = () => {
    const myDatetime = wasUpdated() ? new Date(modDatetime!) : new Date(pubDateTime);

    const date = myDatetime.toLocaleDateString(locale, {
        day: "numeric",
        month: "short",
        year: "numeric",
    });

    const time = myDatetime.toLocaleTimeString(locale, {
        hour: "2-digit",
        minute: "2-digit",
    });

    return {
        iso: myDatetime.toISOString(),
        date: date,
        time: time,
    };
};
---

<span>{wasUpdated() ? m.blog__published_date_title() : m.blog__updated_date_title()}</span>
<time datetime={formattedDatetime().iso}>{formattedDatetime().date}</time>
<span> | </span>
<span>{formattedDatetime().time}</span>

<style>
    span,
    time {
        font-size: inherit;
        font-weight: inherit;
    }
</style>
