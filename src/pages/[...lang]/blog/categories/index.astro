---
import BreadCrumbs from "@components/astro/blog/BreadCrumbs.astro";
import BreadCrumbsItem from "@components/astro/blog/BreadCrumbsItem.astro";
import Category from "@components/astro/blog/Category.astro";
import Section from "@components/astro/global/Section.astro";
import { loadNamespaces, t } from "@i18n/i18n";
import { getLocale, getStaticPaths } from "@i18n/utils";
import PageLayout from "@layouts/PageLayout.astro";
import { getRelativeLocaleUrl } from "astro:i18n";
export { getStaticPaths };
import { getAllCategoriesByLocale } from "@services/content/getAllCategoriesByLocale";

// i18n
const locale = getLocale(Astro.url);
await loadNamespaces(locale, ["blog", "common"]);

const layoutProps = {
    title: `${t("blog.categories")} - Blog`,
    description: t("blog.blog_site_description"),
};
// Categories
const categories = await getAllCategoriesByLocale({ locale });
---

<PageLayout {...layoutProps}>
    <BreadCrumbs>
        <BreadCrumbsItem href={getRelativeLocaleUrl(locale, "/home")} label={t("common.home")} />
        <BreadCrumbsItem href={getRelativeLocaleUrl(locale, "/blog")} label="Blog" />
        <BreadCrumbsItem currentPage={true} label={t("blog.categories")} />
    </BreadCrumbs>
    <Section id="categories" isFirstSection sectionTitle={t("blog.categories")} sectionDescription={t("blog.categories_description")}>
        {!categories && <p>{t("blog.no_categories")}</p>}
        {
            categories && (
                <ul class="category-list">
                    {categories?.map((category) => (
                        <Category {category} />
                    ))}
                </ul>
            )
        }
    </Section>
</PageLayout>

<style>
    .category-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;

        a {
            color: var(--body-color);
            display: inline-block;

            &:visited {
                color: var(--body-color);
            }

            &:hover {
                color: rgba(var(--accent), 1);
            }
        }
    }
</style>
