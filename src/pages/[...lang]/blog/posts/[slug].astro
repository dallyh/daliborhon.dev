---
import { getCollection } from "astro:content";
import BlogPostLayout from "@layouts/BlogPostLayout.astro";
import { getRoutingLocale } from "@i18n/utils";
import { getBlogPostSlug } from "@utils/getBlogPostSlug";

export async function getStaticPaths() {
    const allPosts = await getCollection("posts", ({ data }) => {
        return !data.draft;
    });
    const paths = allPosts.map((post) => {
        return { params: { lang: getRoutingLocale(post.data.language), slug: getBlogPostSlug(post.data.language, post) }, props: { post: post } };
    });

    return paths;
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BlogPostLayout post={post}>
    <Content />
</BlogPostLayout>
