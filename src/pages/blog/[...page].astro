---
import { getCollection } from "astro:content";
import type { GetStaticPathsOptions } from "astro";
import { defaultLocale } from "@i18n/config";
import BlogLayout from "@layouts/BlogLayout.astro";
import { SITE } from "@config";

export const locale = defaultLocale;

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
    const posts = await getCollection("posts", ({ data }) => {
        return data.language === locale && !data.draft;
    });

    const sortedPosts = posts.sort((a, b) => new Date(b.data.pubDateTime).valueOf() - new Date(a.data.pubDateTime).valueOf());
    return paginate(sortedPosts, { pageSize: SITE.pageSize });
}

const { page } = Astro.props;
---

<BlogLayout page={page} />
